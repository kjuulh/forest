FROM rust:1.91-trixie AS builder

WORKDIR /app

COPY Cargo.toml Cargo.lock ./

COPY src src

RUN cargo build --release

FROM debian:trixie-slim AS final

WORKDIR /

COPY --from=builder /app/target/release/{{ config.name }} /usr/local/bin/{{ config.name }}

RUN {{ config.name }} --help

CMD [ "{{ config.name }}" ]
